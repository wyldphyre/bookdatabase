{% extends "base.html" %}

{% block title %}Recommendations - Book Database{% endblock %}

{% block content %}
<h1>Recommendations</h1>

<section>
    <h2>Continue Reading</h2>
    {% if continue_reading %}
    <div class="rec-grid">
        {% for book, last_read, _ in continue_reading %}
        <a href="{{ url_for('book_detail', id=book.id) }}" class="rec-card">
            {% if book.cover_image %}
            <img src="{{ url_for('static', filename='uploads/' + book.cover_image) }}" alt="{{ book.title }}" loading="lazy">
            {% else %}
            <div class="rec-cover-placeholder">{{ book.title[0] }}</div>
            {% endif %}
            <div class="rec-info">
                <strong>{{ book.title }}</strong>
                {% if book.authors %}
                <small>{% for author in book.authors %}{{ author.name }}{% if not loop.last %}, {% endif %}{% endfor %}</small>
                {% endif %}
                {% if book.series %}
                <small class="rec-series">{{ book.series.name }}{% if book.series_number %} #{{ book.series_number|num }}{% endif %}</small>
                {% endif %}
                {% if last_read %}
                <small class="rec-meta">After: {{ last_read.title }}{% if last_read.series_number %} (#{{ last_read.series_number|num }}){% endif %}</small>
                {% endif %}
                {% if book.page_count %}
                <small class="rec-meta">{{ book.page_count }} pages</small>
                {% endif %}
            </div>
        </a>
        {% endfor %}
    </div>
    {% else %}
    <article>
        <p>No series continuations to suggest. Complete a book in a series to get recommendations here.</p>
    </article>
    {% endif %}
</section>

<section>
    <h2>From the Pile</h2>
    {% if from_the_pile %}
    <div class="rec-grid">
        {% for book in from_the_pile %}
        <a href="{{ url_for('book_detail', id=book.id) }}" class="rec-card">
            {% if book.cover_image %}
            <img src="{{ url_for('static', filename='uploads/' + book.cover_image) }}" alt="{{ book.title }}" loading="lazy">
            {% else %}
            <div class="rec-cover-placeholder">{{ book.title[0] }}</div>
            {% endif %}
            <div class="rec-info">
                <strong>{{ book.title }}</strong>
                {% if book.authors %}
                <small>{% for author in book.authors %}{{ author.name }}{% if not loop.last %}, {% endif %}{% endfor %}</small>
                {% endif %}
                {% if book.series %}
                <small class="rec-series">{{ book.series.name }}{% if book.series_number %} #{{ book.series_number|num }}{% endif %}</small>
                {% endif %}
                {% if book.page_count %}
                <small class="rec-meta">{{ book.page_count }} pages</small>
                {% endif %}
            </div>
        </a>
        {% endfor %}
    </div>
    {% else %}
    <article>
        <p>You've read everything in your library!</p>
    </article>
    {% endif %}
</section>
{% endblock %}
