{% extends "base.html" %}

{% block title %}Authors - Book Database{% endblock %}

{% block content %}
<header>
    <hgroup>
        <h1>Authors</h1>
        <p>Browse and manage authors</p>
    </hgroup>
    <a href="{{ url_for('author_new') }}" role="button">Add New Author</a>
</header>

<form action="{{ url_for('author_list') }}" method="get">
    <input type="search" name="search" id="author-list-search" placeholder="Search authors..." value="{{ search }}"
           hx-get="{{ url_for('author_list') }}"
           hx-trigger="keyup changed delay:300ms"
           hx-target="#author-results"
           hx-select="#author-results"
           hx-push-url="true">
</form>

<div id="author-results">

{% if authors %}
    <div class="author-grid">
        {% for author in authors %}
        <div class="author-card">
            <div class="author-info">
                <a href="{{ url_for('author_detail', id=author.id) }}"><strong>{{ author.name }}</strong></a>
                {% if author.pronouns %}<small>({{ author.pronouns }})</small>{% endif %}
                {% if author.gender %}<br><small class="secondary">{{ author.gender.name }}</small>{% endif %}
                {% set book_count = author.books|length %}
                {% set series_count = author.books|unique_series_count %}
                <br><small>{{ book_count }} book{{ 's' if book_count != 1 else '' }}{% if series_count %}, {{ series_count }} series{% endif %}</small>
            </div>
            <div class="button-group">
                <a href="{{ url_for('author_edit', id=author.id) }}" role="button" class="outline secondary small">Edit</a>
            </div>
        </div>
        {% endfor %}
    </div>
{% else %}
    <article>
        <p>{% if search %}No authors found matching "{{ search }}".{% else %}No authors yet.{% endif %}</p>
        <a href="{{ url_for('author_new') }}" role="button">Add Your First Author</a>
    </article>
{% endif %}
</div>
{% endblock %}
