{% extends "base.html" %}

{% block title %}Books - Book Database{% endblock %}

{% block content %}
<header>
    <hgroup>
        <h1>Books</h1>
        <p>{{ books.total }} book{{ 's' if books.total != 1 else '' }} in your library</p>
    </hgroup>
    <a href="{{ url_for('book_new') }}" role="button">Add New Book</a>
</header>

{% if books.items %}
<div class="book-grid">
    {% for book in books.items %}
    <a href="{{ url_for('book_detail', id=book.id) }}" class="book-card" style="text-decoration: none; color: inherit;">
        {% if book.cover_image %}
        <img src="{{ url_for('static', filename='uploads/' + book.cover_image) }}" alt="{{ book.title }}">
        {% else %}
        <div class="placeholder-cover">ðŸ“š</div>
        {% endif %}
        <div class="book-card-content">
            <div class="book-card-title">{{ book.title }}</div>
            <div class="book-card-author">{{ book.author_names or 'Unknown Author' }}</div>
            {% if book.rating %}
            <div class="rating">
                {% for i in range(5) %}
                    {% if book.rating >= i + 1 %}â˜…{% elif book.rating >= i + 0.5 %}â˜…{% else %}â˜†{% endif %}
                {% endfor %}
                ({{ book.rating }})
            </div>
            {% endif %}
        </div>
    </a>
    {% endfor %}
</div>

{% if books.pages > 1 %}
<nav class="pagination">
    {% if books.has_prev %}
    <a href="{{ url_for('book_list', page=books.prev_num) }}">Previous</a>
    {% endif %}

    {% for page in books.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
        {% if page %}
            {% if page == books.page %}
            <span class="current">{{ page }}</span>
            {% else %}
            <a href="{{ url_for('book_list', page=page) }}">{{ page }}</a>
            {% endif %}
        {% else %}
        <span>...</span>
        {% endif %}
    {% endfor %}

    {% if books.has_next %}
    <a href="{{ url_for('book_list', page=books.next_num) }}">Next</a>
    {% endif %}
</nav>
{% endif %}

{% else %}
<article>
    <p>No books in your library yet.</p>
    <a href="{{ url_for('book_new') }}" role="button">Add Your First Book</a>
</article>
{% endif %}
{% endblock %}
